<?xml version="1.0" encoding="utf-8"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009"
					   xmlns:s="library://ns.adobe.com/flex/spark"
					   xmlns:mx="library://ns.adobe.com/flex/mx" height="600" width="800"
					   creationComplete="windowedapplication1_creationCompleteHandler(event)"
					   invoke="windowedapplication1_invokeHandler(event)"
					   implements="view.IMainView">

	<fx:Script>
		<![CDATA[
			import mx.events.FlexEvent;
			import mx.events.ItemClickEvent;

			import presenter.MainPresenter;

			import view.IMainView;
			import view.MainViewPendingRenderer;
			[Bindable]
			private var m_presenter:MainPresenter;

			private function windowedapplication1_creationCompleteHandler(event:FlexEvent):void
			{
				m_presenter = new MainPresenter(this);
			}


			private function mediaType_itemClickHandler(event:ItemClickEvent):void
			{
				currentState = mediaType.selection.id;
			}


			protected function windowedapplication1_invokeHandler(event:InvokeEvent):void
			{
//				var args:Array = new Array();
//				for each (var s:String in event.arguments)
//				{
//					args.push(s.toLowerCase());
//				}
//				m_presenter.autoRun = args.indexOf("autorun")!=-1;
//				m_presenter.processOnlyRecognizedShows = args.indexOf("knownonly")!=-1;
			}

		]]>
	</fx:Script>

	<fx:Declarations>
			<s:RadioButtonGroup id="mediaType"
								itemClick="mediaType_itemClickHandler(event)">
			</s:RadioButtonGroup>

	</fx:Declarations>
	<s:HGroup top="10" bottom="10" left="10" right="10">
		<s:VGroup left="10" paddingLeft="10" paddingTop="10" width="100%" height="100%">
			<s:HGroup>
				<s:Label text="Source path:"/>
				<s:TextInput id="inputDir"  text="@{m_presenter.inputDir}"/>
				<s:Button label="Scan" click="{m_presenter.scanDirectory()}"/>
				<s:CheckBox label="Recursive" selected="@{m_presenter.recursiveScan}"/>
			</s:HGroup>
			<s:Label id="currentFile" text="{m_presenter.currentFileName}"/>
			<s:HGroup height="53" width="221" right="0">
				<s:Label text="Name:" height="21"/>
				<s:TextInput width="165"  id="mediaName" text="@{m_presenter.mediaName}"/>
			</s:HGroup>
			<s:HGroup height="53" width="221" right="0">
				<s:Label height="21" text="Season:"/>
				<s:TextInput width="150" id="seasonInput" text="@{m_presenter.season}"/>
			</s:HGroup>
			<s:HGroup>
				<s:Label text="Target path:"/>
				<s:TextInput id="targetBase" text="@{m_presenter.outputDir}"/>
				<s:CheckBox label="Scrape" selected="@{m_presenter.scrape}"/>
			</s:HGroup>
			<s:HGroup height="53" width="221" right="0">
				<s:Label text="Move to:" height="21"/>
				<s:TextInput width="265" id="targetFolder" text="@{m_presenter.targetPath}"/>
			</s:HGroup>
			<s:HGroup>
				<s:Button label="Apply to selection" click="{m_presenter.applyChanges(pendingList.selectedItems); pendingList.dataGroup.invalidateDisplayList();}"/>
				<s:Button label="Delete selection" click="{m_presenter.removeFromPendingList(pendingList.selectedItems);pendingList.dataGroup.invalidateDisplayList();}"/>
			</s:HGroup>
			<s:Label id="copyStatus" text="{m_presenter.copyStatus}"/>
			<s:Label id="scraperStatus" text="{m_presenter.scraperStatus}"/>
			<s:Button label="Move!" click="{m_presenter.beginMove();}"/>
		</s:VGroup>
		<mx:Spacer width="20"/>
		<s:List id="pendingList" dataProvider="{m_presenter.pendingFiles}" change="{m_presenter.modifyFiles(pendingList.selectedItems)}" bottom="10" right="10" width="100%" height="100%" allowMultipleSelection="true" itemRenderer="view.MainViewPendingRenderer">

		</s:List>
	</s:HGroup>
</s:WindowedApplication>
